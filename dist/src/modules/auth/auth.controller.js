import{findUserByEmail}from"../user/user.service.js";import{verifyPassword}from"../../utils/hash.js";export const loginHandler=async(request,reply)=>{const body=request.body;const user=await findUserByEmail(body.email);if(!user){return reply.status(401).send({message:"Invalid email address. Try again!"})};const isValidPassword=verifyPassword({candidatePassword:body.password,salt:user.salt,hash:user.password});if(!isValidPassword){return reply.status(401).send({message:"Password is incorrect"})};const payload={id:user.id,email:user.email,first_name:user.first_name};const token=request.jwt.sign(payload);reply.setCookie("access_token",token,{path:"/",httpOnly:true,secure:true,...!body.remember?{maxAge:1e3*60*60*24*7}:null});return{accessToken:token}};export const logoutHandler=async(_,reply)=>{reply.clearCookie("access_token");return reply.status(201).send({message:"Logout successfully"})};